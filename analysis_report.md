# Аналитический отчёт: прогнозирование цен на автомобили

## 1. Что было сделано

### Этап 1: EDA и предобработка данных
- Загрузка и анализ данных (6999 записей в трейне, 1000 в тесте)
- Проверка пропусков и их заполнение медианами
- Удаление дубликатов (осталось 5840 записей)
- Очистка текстовых полей (mileage, engine, max_power от единиц измерения)
- Преобразование типов данных
- Анализ распределений и корреляций
- Удаление столбца torque для упрощения

### Этап 2: Визуализация
- Построение pairplot для анализа взаимосвязей
- Тепловая карта корреляций Пирсона
- Анализ распределения целевой переменной
- Визуализация влияния категориальных признаков

### Этап 3: Моделирование только на вещественных признаках
- Разделение на тренировочную и тестовую выборки
- Обучение LinearRegression (R² = 0.5941)
- Стандартизация признаков
- Применение Lasso и ElasticNet с GridSearchCV
- Определение важности признаков

### Этап 4: Добавление категориальных признаков
- Удаление столбца name (бонус: предобработка не выполнена)
- OneHot-кодирование категориальных признаков
- Обучение Ridge регрессии с GridSearchCV
- Подбор оптимального alpha

### Этап 5: Бизнес-оценка
- Реализация кастомной метрики "точность в пределах 10%"
- Сравнение всех моделей по бизнес-метрике

### Этап 6: Создание Streamlit приложения
- Разработка веб-интерфейса
- Интеграция обученной модели
- Реализация визуализаций
- Поддержка загрузки CSV и ручного ввода

## 2. Результаты и интерпретация

### Метрики качества моделей:

LinearRegression:  R² трейн = 0.5923, R² тест = 0.5941 <br>
Lasso (alpha=1.0): R² трейн = 0.5923, R² тест = 0.5941 <br>
Lasso (best alpha): R² трейн = 0.5682, R² тест = 0.5940 <br>
ElasticNet (best): R² трейн = 0.5761,  R² тест = 0.5722 <br>
**Ridge с категориями:** R² трейн = **0.6208**, R² тест = **0.6029**

### Интерпретация результатов:
1. **LinearRegression показала хорошее базовое качество** (R²=0.5941) без переобучения
2. **Регуляризация почти не повлияла** на качество на вещественных признаках
3. **Добавление категориальных признаков дало прирост +0.0087 к R²**
4. **Ridge с alpha=1000** показал лучший результат благодаря способности работать с высокой размерностью
5. **Наиболее важные признаки**: год выпуска, мощность двигателя, объем двигателя

### Бизнес-интерпретация:
- Модель объясняет ~60% вариативности цен
- Средняя ошибка прогноза ~480,000 ₹
- 41.7% прогнозов находятся в пределах 10% от реальной цены
- Для практического применения нужно достичь хотя бы 60-70% по бизнес-метрике

## 3. Что дало наибольший прирост качества

1. **Категориальные признаки (+2.2% к R²)**:
   - OneHot-кодирование fuel, seller_type, transmission, owner, seats
   - Информация о типе трансмиссии (автомат vs механика) особенно важна

2. **Правильная регуляризация Ridge**:
   - Alpha=1000 оптимален для высокой размерности (много OneHot-признаков)
   - L1-регуляризация (Lasso) оказалась менее эффективной

3. **Качественная предобработка**:
   - Очистка числовых признаков от единиц измерения
   - Заполнение пропусков медианами
   - Преобразование типов данных

## 4. Что сделать не удалось и почему

1. **Предобработка столбца torque**:
   - Не выполнена из-за сложности парсинга строковых значений
   - В данных содержались значения вида "190Nm@ 2000rpm", требовался сложный парсинг
   - **Решение**: столбец был удалён для упрощения

2. **Достижение бизнес-метрики > 60%**:
   - Максимальный результат 41.7% недостаточен для production
   - **Причина**: ограниченность линейных моделей, нужны более сложные алгоритмы
   - **Решение для будущего**: использование градиентного бустинга или нейросетей

3. **Извлечение дополнительных признаков из name**:
   - Бонусное задание не выполнено из-за нехватки времени
   - **Потенциальное улучшение**: извлечение марки, модели, типа кузова

## 5. Оценка разработанного сервиса (тут попросил ml-ку оценить)

### Удобство использования: 8/10
**Хорошо:**
- Интуитивная навигация через сайдбар
- Два способа ввода (ручной и CSV)
- Быстрая обработка запросов
- Понятные сообщения об ошибках

**Можно улучшить:**
- Добавить валидацию полей ввода
- Реализовать сохранение истории
- Добавить примеры данных для скачивания

### Визуализация: 9/10
**Отлично получилось:**
- Интерактивные графики Plotly с zoom
- Тепловая карта корреляций
- Визуализация важности признаков с цветовой кодировкой
- Адаптивные layout'ы

**Менее удачно:**
- Ограниченное количество типов графиков
- Нет сравнения нескольких моделей в одном интерфейсе

### Ограничения и проблемы:
1. **Производительность**: при загрузке больших CSV (>10MB) возможны задержки
2. **Память**: модель занимает ~50MB в памяти
3. **Масштабируемость**: текущая версия для демо, не для production
4. **Безопасность**: нет аутентификации пользователей
5. **Ограниченность модели**: только Ridge регрессия, нет ансамблей

### Планируемые улучшения:
1. **Модельные**:
   - Добавление XGBoost/LightGBM
   - Ансамбли моделей
   - Нелинейные преобразования признаков

2. **Интерфейсные**:
   - Валидация входных данных
   - Экспорт результатов в PDF/Excel
   - История запросов
   - Сравнение нескольких моделей

3. **Архитектурные**:
   - Кэширование результатов
   - API для интеграции
   - Docker-контейнеризация
   - Мониторинг метрик

## 6. Инструкция по запуску

1. **Установка зависимостей**:
```bash
pip install -r requirements.txt
```

2. **Запуск приложения:**
```bash
streamlit run app.py
```

3. **Страница в браузере:**
```bash
http://localhost:8501
```
